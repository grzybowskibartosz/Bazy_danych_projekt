{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\barto\\\\PycharmProjects\\\\bazy danych v1.0\\\\rejestracja_internetowa\\\\frontend_part\\\\src\\\\Login.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Typography from '@mui/material/Typography';\nimport TextField from '@mui/material/TextField';\nimport Button from '@mui/material/Button';\nimport { styled } from '@mui/system';\nimport { Link } from 'react-router-dom';\nimport Pacjent from './PatientPanel';\nimport Lekarz from './DoctorPanel';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst StyledFormContainer = styled('div')({\n  width: '50%',\n  margin: '0 auto',\n  marginTop: '50px'\n});\n_c = StyledFormContainer;\nconst StyledForm = styled('form')({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '16px'\n});\n_c2 = StyledForm;\nconst StyledButton = styled(Button)({\n  marginTop: '16px',\n  backgroundColor: '#26a197'\n});\n_c3 = StyledButton;\nconst Login = () => {\n  _s();\n  const [loginData, setLoginData] = useState({\n    username: '',\n    password: ''\n  });\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [loginError, setLoginError] = useState('');\n  const [userInfo, setUserInfo] = useState({});\n  //const [panelComponent, setPanelComponent] = useState(null);\n\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setLoginData(prevData => ({\n      ...prevData,\n      [name]: value\n    }));\n  };\n  const getUserInfo = async () => {\n    try {\n      const token = localStorage.getItem('authToken'); // Użyj bardziej ogólnego klucza\n      const response = await axios.get('http://localhost:8000/api/get_user_info/', {\n        headers: {\n          Authorization: `Token ${token}`\n        }\n      });\n      const userInfo = response.data;\n      setUserInfo(userInfo);\n    } catch (error) {\n      console.error('Błąd pobierania informacji o użytkowniku:', error);\n    }\n  };\n  const handleLogin = async () => {\n    try {\n      const response = await axios.post('http://localhost:8000/api/login/', loginData);\n      const authToken = response.data.token;\n\n      // Zapisz token w localStorage\n      localStorage.setItem('authToken', authToken);\n      console.log('Zalogowano:', authToken);\n      setLoggedIn(true);\n      setLoginError('');\n      getUserInfo();\n    } catch (error) {\n      console.error('Błąd logowania:', error);\n      setLoggedIn(false);\n      setLoginError('Błąd logowania. Sprawdź poprawność danych.');\n    }\n  };\n  const handleLogout = () => {\n    setLoggedIn(false);\n  };\n  useEffect(() => {\n    if (loggedIn) {\n      getUserInfo();\n    }\n  }, [loggedIn]);\n  return /*#__PURE__*/_jsxDEV(StyledFormContainer, {\n    children: loggedIn ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        children: \"Jeste\\u015B zalogowany\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this), userInfo.role === 'patient' && /*#__PURE__*/_jsxDEV(Pacjent, {\n        userData: userInfo.user_data\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 43\n      }, this), userInfo.role === 'doctor' && /*#__PURE__*/_jsxDEV(Lekarz, {\n        userData: userInfo.user_data\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 42\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"secondary\",\n        onClick: handleLogout,\n        children: \"Wyloguj\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        children: \"Panel Logowania\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(StyledForm, {\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Nazwa u\\u017Cytkownika\",\n          name: \"username\",\n          value: loginData.username,\n          onChange: handleInputChange,\n          variant: \"outlined\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Has\\u0142o\",\n          name: \"password\",\n          value: loginData.password,\n          onChange: handleInputChange,\n          variant: \"outlined\",\n          type: \"password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this), loginError && /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          color: \"error\",\n          children: loginError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(StyledButton, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: handleLogin,\n          children: \"Zaloguj\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          children: \"Przejd\\u017A do strony g\\u0142\\xF3wnej\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"x5lvpRg58ApqET4k/DU5INGKfZY=\");\n_c4 = Login;\nexport default Login;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"StyledFormContainer\");\n$RefreshReg$(_c2, \"StyledForm\");\n$RefreshReg$(_c3, \"StyledButton\");\n$RefreshReg$(_c4, \"Login\");","map":{"version":3,"names":["React","useState","useEffect","axios","Typography","TextField","Button","styled","Link","Pacjent","Lekarz","jsxDEV","_jsxDEV","StyledFormContainer","width","margin","marginTop","_c","StyledForm","display","flexDirection","gap","_c2","StyledButton","backgroundColor","_c3","Login","_s","loginData","setLoginData","username","password","loggedIn","setLoggedIn","loginError","setLoginError","userInfo","setUserInfo","handleInputChange","e","name","value","target","prevData","getUserInfo","token","localStorage","getItem","response","get","headers","Authorization","data","error","console","handleLogin","post","authToken","setItem","log","handleLogout","children","variant","fileName","_jsxFileName","lineNumber","columnNumber","role","userData","user_data","color","onClick","label","onChange","type","to","_c4","$RefreshReg$"],"sources":["C:/Users/barto/PycharmProjects/bazy danych v1.0/rejestracja_internetowa/frontend_part/src/Login.js"],"sourcesContent":["import React, {useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Typography from '@mui/material/Typography';\r\nimport TextField from '@mui/material/TextField';\r\nimport Button from '@mui/material/Button';\r\nimport { styled } from '@mui/system';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport Pacjent from './PatientPanel';\r\nimport Lekarz from './DoctorPanel';\r\n\r\nconst StyledFormContainer = styled('div')({\r\n  width: '50%',\r\n  margin: '0 auto',\r\n  marginTop: '50px',\r\n});\r\n\r\nconst StyledForm = styled('form')({\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  gap: '16px',\r\n});\r\n\r\nconst StyledButton = styled(Button)({\r\n  marginTop: '16px',\r\n  backgroundColor: '#26a197',\r\n});\r\n\r\nconst Login = () => {\r\n  const [loginData, setLoginData] = useState({\r\n    username: '',\r\n    password: '',\r\n  });\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n  const [loginError, setLoginError] = useState('');\r\n  const [userInfo, setUserInfo] = useState({});\r\n  //const [panelComponent, setPanelComponent] = useState(null);\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setLoginData((prevData) => ({\r\n      ...prevData,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\nconst getUserInfo = async () => {\r\n  try {\r\n    const token = localStorage.getItem('authToken'); // Użyj bardziej ogólnego klucza\r\n    const response = await axios.get('http://localhost:8000/api/get_user_info/', {\r\n      headers: {\r\n        Authorization: `Token ${token}`,\r\n      },\r\n    });\r\n    const userInfo = response.data;\r\n    setUserInfo(userInfo);\r\n  } catch (error) {\r\n    console.error('Błąd pobierania informacji o użytkowniku:', error);\r\n  }\r\n};\r\n\r\nconst handleLogin = async () => {\r\n  try {\r\n    const response = await axios.post('http://localhost:8000/api/login/', loginData);\r\n    const authToken = response.data.token;\r\n\r\n    // Zapisz token w localStorage\r\n    localStorage.setItem('authToken', authToken);\r\n\r\n    console.log('Zalogowano:', authToken);\r\n    setLoggedIn(true);\r\n    setLoginError('');\r\n    getUserInfo();\r\n  } catch (error) {\r\n    console.error('Błąd logowania:', error);\r\n    setLoggedIn(false);\r\n    setLoginError('Błąd logowania. Sprawdź poprawność danych.');\r\n  }\r\n};\r\n\r\n\r\n  const handleLogout = () => {\r\n    setLoggedIn(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (loggedIn) {\r\n      getUserInfo();\r\n    }\r\n  }, [loggedIn]);\r\n\r\n\r\n\r\n  return (\r\n    <StyledFormContainer>\r\n      {loggedIn ? (\r\n        <div>\r\n          <Typography variant=\"h5\">Jesteś zalogowany</Typography>\r\n          {userInfo.role === 'patient' && <Pacjent userData={userInfo.user_data} />}\r\n          {userInfo.role === 'doctor' && <Lekarz userData={userInfo.user_data} />}\r\n          <Button variant=\"contained\" color=\"secondary\" onClick={handleLogout}>\r\n            Wyloguj\r\n          </Button>\r\n        </div>\r\n      ) : (\r\n        <div>\r\n          <Typography variant=\"h5\">Panel Logowania</Typography>\r\n          <StyledForm>\r\n            <TextField\r\n              label=\"Nazwa użytkownika\"\r\n              name=\"username\"\r\n              value={loginData.username}\r\n              onChange={handleInputChange}\r\n              variant=\"outlined\"\r\n            />\r\n            <TextField\r\n              label=\"Hasło\"\r\n              name=\"password\"\r\n              value={loginData.password}\r\n              onChange={handleInputChange}\r\n              variant=\"outlined\"\r\n              type=\"password\"\r\n            />\r\n            {loginError && (\r\n              <Typography variant=\"body2\" color=\"error\">\r\n                {loginError}\r\n              </Typography>\r\n            )}\r\n            <StyledButton\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              onClick={handleLogin}\r\n            >\r\n              Zaloguj\r\n            </StyledButton>\r\n            <Link to=\"/\">Przejdź do strony głównej</Link>\r\n          </StyledForm>\r\n        </div>\r\n      )}\r\n    </StyledFormContainer>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}